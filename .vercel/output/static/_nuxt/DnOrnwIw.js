import{_ as w}from"./CP_9KE0U.js";import{r as f,k as h,f as y,c as g,o as p,a as e,n as S,g as s,t as n,d as b,h as C,F as T,i as L,b as $,w as D,e as N}from"./71iuM9A_.js";import{u as U}from"./-LzsfN83.js";const k={class:"min-h-screen bg-gray-50 py-8"},E={class:"max-w-4xl mx-auto px-4"},V={class:"bg-white rounded-lg shadow-md p-6"},B={class:"flex items-center"},I={class:"text-lg font-semibold"},K={class:"text-sm mt-1"},O={class:"mb-6"},P={class:"bg-gray-100 p-4 rounded-lg space-y-2"},R={class:"mb-6"},A=["disabled"],z={key:0,class:"bg-gray-100 p-4 rounded-lg"},F={class:"text-sm"},J={class:"mb-6"},M={class:"bg-black text-green-400 p-4 rounded-lg text-sm font-mono max-h-64 overflow-y-auto"},Y={class:"pt-4 border-t"},Q={__name:"test-supabase",setup(j){const i=U(),u=N(),c=f(!1),l=f(null),o=f([]),d=h(()=>{const a=!!u.public.supabaseUrl,t=!!u.public.supabaseKey,r=u.public.supabaseUrl?`${u.public.supabaseUrl.slice(0,30)}...`:"Não configurada";return{hasUrl:a,hasKey:t,urlPreview:r}}),v=h(()=>!d.value.hasUrl||!d.value.hasKey?{class:"bg-red-100 border border-red-300 text-red-800",title:"❌ Configuração Incompleta",message:"Variáveis de ambiente do Supabase não estão configuradas corretamente."}:i?{class:"bg-green-100 border border-green-300 text-green-800",title:"✅ Configuração OK",message:"Variáveis de ambiente configuradas e cliente Supabase inicializado."}:{class:"bg-yellow-100 border border-yellow-300 text-yellow-800",title:"⚠️ Cliente Não Inicializado",message:"O cliente Supabase não foi inicializado corretamente."}),_=async()=>{c.value=!0,l.value=null;try{if(o.value.push(`[${new Date().toLocaleTimeString()}] Iniciando teste da tabela...`),!i)throw new Error("Cliente Supabase não disponível");o.value.push(`[${new Date().toLocaleTimeString()}] Testando count...`);const{count:a,error:t}=await i.from("funcionarios").select("*",{count:"exact",head:!0});if(t)throw t;o.value.push(`[${new Date().toLocaleTimeString()}] Count concluído: ${a} registros`),o.value.push(`[${new Date().toLocaleTimeString()}] Buscando registros...`);const{data:r,error:m}=await i.from("funcionarios").select("*").limit(5);if(m)throw m;o.value.push(`[${new Date().toLocaleTimeString()}] Busca concluída: ${r?.length||0} registros encontrados`),l.value={success:!0,count:a,sample_records:r,timestamp:new Date().toISOString()}}catch(a){o.value.push(`[${new Date().toLocaleTimeString()}] ERRO: ${a.message}`),l.value={success:!1,error:a.message,timestamp:new Date().toISOString()}}finally{c.value=!1}};return y(()=>{o.value.push(`[${new Date().toLocaleTimeString()}] Página de teste carregada`),o.value.push(`[${new Date().toLocaleTimeString()}] Cliente Supabase: ${i?"Disponível":"Não disponível"}`)}),(a,t)=>{const r=w;return p(),g("div",k,[e("div",E,[e("div",V,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-gray-900 mb-6"},"🧪 Teste de Conectividade Supabase",-1)),e("div",{class:S(["mb-6 p-4 rounded-lg",s(v).class])},[e("div",B,[e("div",I,n(s(v).title),1)]),e("div",K,n(s(v).message),1)],2),e("div",O,[t[3]||(t[3]=e("h2",{class:"text-lg font-semibold mb-3"},"📋 Variáveis de Ambiente",-1)),e("div",P,[e("div",null,[t[0]||(t[0]=e("strong",null,"SUPABASE_URL:",-1)),b(" "+n(s(d).hasUrl?"✅ Configurada":"❌ Não configurada"),1)]),e("div",null,[t[1]||(t[1]=e("strong",null,"SUPABASE_KEY:",-1)),b(" "+n(s(d).hasKey?"✅ Configurada":"❌ Não configurada"),1)]),e("div",null,[t[2]||(t[2]=e("strong",null,"URL Preview:",-1)),b(" "+n(s(d).urlPreview),1)])])]),e("div",R,[t[4]||(t[4]=e("h2",{class:"text-lg font-semibold mb-3"},"📊 Teste da Tabela 'funcionarios'",-1)),e("button",{onClick:_,disabled:s(c),class:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50 mb-4"},n(s(c)?"Testando...":"Testar Conexão com Tabela"),9,A),s(l)?(p(),g("div",z,[e("pre",F,n(JSON.stringify(s(l),null,2)),1)])):C("",!0)]),e("div",J,[t[5]||(t[5]=e("h2",{class:"text-lg font-semibold mb-3"},"📝 Console Logs",-1)),e("div",M,[(p(!0),g(T,null,L(s(o),(m,x)=>(p(),g("div",{key:x},n(m),1))),128))])]),e("div",Y,[$(r,{to:"/",class:"text-primary-600 hover:text-primary-800 font-medium"},{default:D(()=>[...t[6]||(t[6]=[b(" ← Voltar para a página principal ",-1)])]),_:1})])])])])}}};export{Q as default};
